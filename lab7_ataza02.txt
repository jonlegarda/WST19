Web Sistemak - Lab 7 - 2017/11/30

Egileak: Manex Lizaso eta Jon Legarda

Hautazkoa 2: Pasahitz ahaztuen aldaketa.

Pasahitzak aldatzeko funtzionalitatea ere garatu egin dugu. 

Horretarako bi modutan egin dugu.

Lehenik eta behin, mezua emailera bidaltzea ahalegindu gara, eta mezua bidaltzen
dela erabiltzaileari konprobatu dugu, baina erabiltzaileri ez zaio iristen. Suposatzen
dugu, 000webhost-aren nolabaiteko akats edo konfigurazio arazoren bat egongo dela,
baina bidaltzen duen funtzioak (mail()) ziurtatzen digu mezua bidali zaiola.
Horretarako, bi fitxategi daude: forgetPassword.php eta changePassword.php.
Funtzionamendua izango litzateke erabiltzaileak "Pasahitza ahaztu al duzu?" estekan klikatzean
hurrengo orrian bere emaila idatziz, haren emailera jasoko zuela mezu bat non
beste esteka baten bitartez pasahitza aldatzeko orria atzigarri izango lukeen. 
Hau da horren adibidea:

	$titulua = "Pasahitza aldatzeko zerbitzua - Crazy Questions";
	$mezua = "Kaixo, $postaElektronikoaTO! Pasahitza aldatzeko eskatu diguzu.
			Horretarako, bi pausu bete beharko dituzu. Lehenik eta behin, behean agertzen den estekan klikatu. 
			Ondoren, pasahitz berria bi aldiz idatzi eta aldatuta izango duzu.
			<a href='changePassword.php?posta=$postaElektronikoaTO'>Esteka</a> Mila esker!";
	$goiburua = 'From: crazyquestions@ws.com' . "\r\n" .
			'Reply-To: jonlegarda002@gmail.com' . "\r\n" .
			'X-Mailer: PHP/' . phpversion();
	mail($postaElektronikoaTO, $titulua, $mezua, $goiburua);

Espero dugu baloratzea. HALA ETA GUZTIZ ERE, AIPATU BEZALA FUNTZIONALITATE 
HORRETAN EDUKITAKO ARAZOAK DIRELA ETA, BESTE MODU BATEAN EGIN DUGU ETA HORI
IZANGO DA ERABILTZAILEAK AURKITUKO DUENA.

Bigarren modu horretarako funtzionamendu sinple bat erabili dugu:

Bide honetan, erabiltzaileari haren nickname eta emaila eskatuko zaizkio
eta zuzen baldin badira, pasahitza aldatzeko pantaila batera joango da.

Horretarako erabili ditugun bi fitxategiak honako hauek dira:
forgetPassword_galdera.php eta changePassword_galdera.php.

Horretarako, forgetPassword_galdera.php-en begiratzen dira beti bezala formulario batetik
jasotako informazioa sql sententzia batean ezarriz:
$sql = "SELECT * FROM users WHERE PostaElektronikoa='$postaElektronikoa' AND Nick='$nickname'";
Hori exekutatuta biak koinziditzen badute, aurrera segituko du eta changePassword_galdera.php
orrira pasako da. Non bi pasahitz seguruak (ajax bidez ikusita) eta ahulak ez direnak
sartu beharko diren eta biak berdinak baldin badira, UPDATE motako sql sententzia
bat erabilita gordeko den enkriptatua, nola ez, datu-basean. 
Hau da sql sententzia eta enkriptatzeko metodoa:
	$enkripPasahitza = crypt($trimPasahitza, "wsLizasoLegardaEnkriptazioPasahitza");
	$sql = "UPDATE users SET Pasahitza='$enkripPasahitza' WHERE PostaElektronikoa='$postaElektronikoa'";

Ikus gehiago Git-Hubeko kodean.









	
